<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Apartment Finder Map</title>
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
  <style>
    /* Style for map and results */
    #map { height: 600px; width: 100%; }
    #results { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Apartment Finder Map</h1>
  <div id="map"></div>
  <div id="results">
    <h2>Top 3 Best Matches for Apartments</h2>
    <ol id="topResults"></ol>
  </div>

  <script>
    function initMap() {
      const campusLocation = { lat: 30.6175, lng: -96.3404 }; // Texas A&M campus location
      const map = new google.maps.Map(document.getElementById('map'), {
        zoom: 14,
        center: campusLocation,
      });

      // Fetch search data from sessionStorage
      const mapType = sessionStorage.getItem('map-type'); // Should be 'apartment' for this page
      const budgetMin = sessionStorage.getItem('budget-min');
      const budgetMax = sessionStorage.getItem('budget-max');

      // Fetch the top 3 results for apartments based on search data
      const topResults = getTopResults(mapType, budgetMin, budgetMax); // Implement this function to get apartment results

      // Display top results
      const topResultsList = document.getElementById('topResults');
      topResults.forEach(result => {
        const li = document.createElement('li');
        li.textContent = result.name; // Name of the apartment
        topResultsList.appendChild(li);
      });

      // Highlight campus and apartment locations on the map
      highlightCampusAndResults(map, topResults);
    }

    function getTopResults(mapType, budgetMin, budgetMax) {
      // Placeholder: Fetch results from an API or Google GenAI
      // For demonstration, here's some dummy data for apartments
      return [
        { name: 'Best Apartment 1', location: { lat: 30.618, lng: -96.341 } },
        { name: 'Best Apartment 2', location: { lat: 30.616, lng: -96.342 } },
        { name: 'Best Apartment 3', location: { lat: 30.617, lng: -96.343 } },
      ];
    }

    function highlightCampusAndResults(map, results) {
      // Campus Marker
      const campusMarker = new google.maps.Marker({
        position: { lat: 30.6175, lng: -96.3404 },
        map: map,
        title: 'Texas A&M Campus',
      });

      // Apartment Markers
      results.forEach(result => {
        const marker = new google.maps.Marker({
          position: result.location,
          map: map,
          title: result.name,
        });
      });
    }
  </script>
</body>
</html>
